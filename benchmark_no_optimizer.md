# Solar vs solc Gas Comparison (No Optimizer)

Comparison of gas usage and bytecode size between Solar and solc with
optimizer **disabled** for both compilers. This shows raw codegen quality.

**Date:** 2026-01-15
**solc version:** 0.8.28
**Solar branch:** feat/codegen-mir

## Status

Solar codegen is in active development. Many tests fail due to StackUnderflow
errors in the generated bytecode. Only tests that pass in both compilers are
compared below.

| Suite | solc pass | Solar pass | Notes |
|-------|-----------|------------|-------|
| arithmetic | 38 | 0 | StackUnderflow |
| calls | 14 | 0 | StackUnderflow |
| constructor-args | 4 | 0 | StackUnderflow |
| control-flow | 43 | 9 | Partial - revert/require work |
| events | 2 | 2 | ✓ Full pass |
| multi-return | 12 | 4 | Partial - pure functions work |
| storage | 37 | 0 | StackUnderflow |

## Gas Comparison (passing tests only)

### events

| Test | solc gas | Solar gas | Δ gas | Δ % |
|------|----------|-----------|-------|-----|
| test_EmitSimple() | 7025 | 2358 | -4667 | **-66.4%** |
| test_EmitTransfer() | 8460 | 2404 | -6056 | **-71.5%** |

### control-flow

| Test | solc gas | Solar gas | Δ gas | Δ % |
|------|----------|-----------|-------|-----|
| testAnd() | 2492 | 4379 | +1887 | +75.7% |
| testOr() | 2680 | 4401 | +1721 | +64.2% |
| test_DivisionByZeroReverts() | 6424 | 2525 | -3899 | **-60.6%** |
| test_RequireFalseReverts() | 5745 | 2380 | -3365 | **-58.5%** |
| test_RequireTrue() | 5738 | 2336 | -3402 | **-59.2%** |
| test_RequireWithMessageFalseReverts() | 6122 | 2424 | -3698 | **-60.4%** |
| test_RequireWithMessageTrue() | 5848 | 2380 | -3468 | **-59.3%** |
| test_RevertAlwaysReverts() | 5309 | 2435 | -2874 | **-54.1%** |
| test_RevertWithMessageReverts() | 5534 | 2457 | -3077 | **-55.6%** |

### multi-return

| Test | solc gas | Solar gas | Δ gas | Δ % |
|------|----------|-----------|-------|-----|
| testPartialCapture() | 1538 | 414 | -1124 | **-73.0%** |
| testSimpleReturn() | 1636 | 590 | -1046 | **-63.9%** |
| testThree() | 2038 | 478 | -1560 | **-76.5%** |
| testTwo() | 1635 | 392 | -1243 | **-76.0%** |

## Bytecode Size Comparison

| Suite | solc JSON | Solar JSON | Δ size | Δ % |
|-------|-----------|------------|--------|-----|
| arithmetic | 54,504 | 13,680 | -40,824 | -74.9% |
| calls | 43,760 | 7,661 | -36,099 | -82.5% |
| constructor-args | 8,622 | 1,487 | -7,135 | -82.8% |
| control-flow | 2,870 | 514 | -2,356 | -82.1% |
| events | 9,541 | 853 | -8,688 | -91.1% |
| multi-return | 3,109 | 881 | -2,228 | -71.7% |
| storage | 7,258 | 1,673 | -5,585 | -76.9% |

**Note:** Bytecode size is raw JSON file size (includes ABI, metadata).
Solar's smaller size is partly because codegen is incomplete.

## Summary

For the tests that pass in both compilers:

- **Events**: Solar uses **66-71% less gas** than solc
- **Require/Revert**: Solar uses **54-60% less gas** than solc  
- **Multi-return**: Solar uses **64-77% less gas** than solc
- **And/Or operators**: Solar uses **64-76% MORE gas** (needs optimization)

The large gas savings in working tests suggest Solar's raw codegen is efficient
for simple operations. The StackUnderflow failures indicate issues with stack
management for more complex expressions.
